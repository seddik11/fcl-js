import{invariant as e}from"@onflow/util-invariant";import{ExecuteScriptAtLatestBlockRequest as t,AccessAPI as r,ExecuteScriptAtBlockHeightRequest as n,ExecuteScriptAtBlockIDRequest as o,GetAccountAtLatestBlockRequest as s,GetAccountAtBlockHeightRequest as i,GetLatestBlockHeaderRequest as a,GetBlockHeaderByHeightRequest as u,GetBlockHeaderByIDRequest as c,GetLatestBlockRequest as d,GetBlockByHeightRequest as f,GetBlockByIDRequest as l,GetCollectionByIDRequest as g,GetEventsForBlockIDsRequest as m,GetEventsForHeightRangeRequest as p,GetTransactionRequest as S,PingRequest as h,Transaction as v,SendTransactionRequest as B}from"@onflow/protobuf";import{grpc as k}from"@improbable-eng/grpc-web";import{NodeHttpTransport as y}from"@improbable-eng/grpc-web-node-http-transport";import{sansPrefix as b,withPrefix as I}from"@onflow/util-address";var x=function(t,r,n,o){try{return e(o.config,"SDK GRPC Unary Error: context.config must be defined."),Promise.resolve(o.config().get("grpc.metadata",{})).then(function(e){return new Promise(function(o,s){k.unary(r,{request:n,host:t,metadata:new k.Metadata(e),onEnd:function(e){var t=e.statusMessage;e.status===k.Code.OK?o(e.message):s(new Error(t))}})})})}catch(e){return Promise.reject(e)}};k.setDefaultTransport(y());var E=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={});try{return e(n.node,"SDK Send Execute Script Error: opts.node must be defined."),e(r.response,"SDK Send Execute Script Error: context.response must be defined."),e(r.Buffer,"SDK Send Execute Script Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){return t=e,Promise.resolve(t.block.id?D(t,r,n):t.block.height?G(t,r,n):P(t,r,n))})}catch(e){return Promise.reject(e)}},P=function(e,n,o){try{var s=o.unary||x,i=new t,a=n.Buffer.from(e.message.cadence,"utf8");return e.message.arguments.forEach(function(t){return i.addArguments(A(e.arguments[t].asArgument,n))}),i.setScript(a),Promise.resolve(s(o.node,r.ExecuteScriptAtLatestBlock,i,n)).then(function(t){return L(e,n,t)})}catch(e){return Promise.reject(e)}},G=function(e,t,o){try{var s=o.unary||x,i=new n;i.setBlockHeight(Number(e.block.height));var a=t.Buffer.from(e.message.cadence,"utf8");return e.message.arguments.forEach(function(r){return i.addArguments(A(e.arguments[r].asArgument,t))}),i.setScript(a),Promise.resolve(s(o.node,r.ExecuteScriptAtBlockHeight,i,t)).then(function(r){return L(e,t,r)})}catch(e){return Promise.reject(e)}},D=function(e,t,n){try{var s=n.unary||x,i=new o;i.setBlockId(K(e.block.id,t));var a=t.Buffer.from(e.message.cadence,"utf8");return e.message.arguments.forEach(function(r){return i.addArguments(A(e.arguments[r].asArgument,t))}),i.setScript(a),Promise.resolve(s(n.node,r.ExecuteScriptAtBlockID,i,t)).then(function(r){return L(e,t,r)})}catch(e){return Promise.reject(e)}},A=function(e,t){return t.Buffer.from(JSON.stringify(e),"utf8")},K=function(e,t){return t.Buffer.from(e,"hex")};function L(e,t,r){var n=t.response();return n.tag=e.tag,n.encodedData=JSON.parse(t.Buffer.from(r.getValue_asU8()).toString("utf8")),n}function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w.apply(this,arguments)}var _=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={});try{return e(n.node,"SDK Send Get Account Error: opts.node must be defined."),e(r.response,"SDK Get Account Error: context.response must be defined."),e(r.Buffer,"SDK Get Account Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){return t=e,Promise.resolve(null!==t.block.height?U(t,r,n):T(t,r,n))})}catch(e){return Promise.reject(e)}},T=function(e,t,n){try{var o=n.unary||x,i=new s;return i.setAddress(j(b(e.account.addr),t)),Promise.resolve(o(n.node,r.GetAccountAtLatestBlock,i,t)).then(function(r){return C(e,t,r)})}catch(e){return Promise.reject(e)}},U=function(e,t,n){try{var o=n.unary||x,s=new i;return s.setBlockHeight(Number(e.block.height)),s.setAddress(j(b(e.account.addr),t)),Promise.resolve(o(n.node,r.GetAccountAtBlockHeight,s,t)).then(function(r){return C(e,t,r)})}catch(e){return Promise.reject(e)}},H=function(e,t){return t.Buffer.from(e).toString("hex")},j=function(e,t){return function(e,t,r){return r.Buffer.from(e.padStart(16,0),"hex")}(e,0,t)},N={1:"SHA2_256",2:"SHA2_384",3:"SHA3_256",4:"SHA3_384",5:"KMAC128_BLS_BLS12_381"},R={1:"ECDSA_P256",2:"ECDSA_secp256k1",3:"BLS_BLS12_381"};function C(e,t,r){var n=t.response();n.tag=e.tag;var o,s=r.getAccount(),i=(o=s.getContractsMap())?o.getEntryList().reduce(function(e,r){var n;return w({},e,((n={})[r[0]]=t.Buffer.from(r[1]||new UInt8Array).toString("utf8"),n))},{}):{};return n.account={address:I(H(s.getAddress_asU8(),t)),balance:s.getBalance(),code:t.Buffer.from(s.getCode_asU8()||new UInt8Array).toString("utf8"),contracts:i,keys:s.getKeysList().map(function(e){return{index:e.getIndex(),publicKey:H(e.getPublicKey_asU8(),t),signAlgo:e.getSignAlgo(),signAlgoString:R[e.getSignAlgo()],hashAlgo:e.getHashAlgo(),hashAlgoString:N[e.getHashAlgo()],weight:e.getWeight(),sequenceNumber:e.getSequenceNumber(),revoked:e.getRevoked()}})},n}var O=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={});try{return e(n.node,"SDK Send Get Block Header Error: opts.node must be defined."),e(r.response,"SDK Send Get Block Header Error: context.response must be defined."),e(r.Buffer,"SDK Send Get Block Header Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){var o=null!==(t=e).block.height;return Promise.resolve(null!==t.block.id?M(t,r,n):o?J(t,r,n):q(t,r,n))})}catch(e){return Promise.reject(e)}},q=function(e,t,n){try{var o,s=n.unary||x,i=new a;return null!=(o=e.block)&&o.isSealed&&i.setIsSealed(e.block.isSealed),Promise.resolve(s(n.node,r.GetLatestBlockHeader,i,t)).then(function(r){return W(e,t,r)})}catch(e){return Promise.reject(e)}},J=function(e,t,n){try{var o=n.unary||x,s=new u;return s.setHeight(Number(e.block.height)),Promise.resolve(o(n.node,r.GetBlockHeaderByHeight,s,t)).then(function(r){return W(e,t,r)})}catch(e){return Promise.reject(e)}},M=function(e,t,n){try{var o=n.unary||x,s=new c;return s.setId(F(e.block.id,t)),Promise.resolve(o(n.node,r.GetBlockHeaderByID,s,t)).then(function(r){return W(e,t,r)})}catch(e){return Promise.reject(e)}},z=function(e,t){return t.Buffer.from(e).toString("hex")},F=function(e,t){return t.Buffer.from(e,"hex")};function W(e,t,r){var n=r.getBlock(),o=t.response();return o.tag=e.tag,o.blockHeader={id:z(n.getId_asU8(),t),parentId:z(n.getParentId_asU8(),t),height:n.getHeight(),timestamp:n.getTimestamp().toDate().toISOString()},o}var X=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={});try{return e(n.node,"SDK Send Get Block Error: opts.node must be defined."),e(r.response,"SDK Send Get Block Error: context.response must be defined."),e(r.Buffer,"SDK Send Get Block Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){var o=null!==(t=e).block.height;return Promise.resolve(null!==t.block.id?Q(t,r,n):o?Z(t,r,n):V(t,r,n))})}catch(e){return Promise.reject(e)}},V=function(e,t,n){try{var o,s=n.unary||x,i=new d;return null!=(o=e.block)&&o.isSealed&&i.setIsSealed(e.block.isSealed),Promise.resolve(s(n.node,r.GetLatestBlock,i,t)).then(function(r){return ee(e,t,r)})}catch(e){return Promise.reject(e)}},Z=function(e,t,n){try{var o=n.unary||x,s=new f;return s.setHeight(Number(e.block.height)),Promise.resolve(o(n.node,r.GetBlockByHeight,s,t)).then(function(r){return ee(e,t,r)})}catch(e){return Promise.reject(e)}},Q=function(e,t,n){try{var o=n.unary||x,s=new l;return s.setId($(e.block.id,t)),Promise.resolve(o(n.node,r.GetBlockByID,s,t)).then(function(r){return ee(e,t,r)})}catch(e){return Promise.reject(e)}},Y=function(e,t){return t.Buffer.from(e).toString("hex")},$=function(e,t){return t.Buffer.from(e,"hex")};function ee(e,t,r){var n=r.getBlock(),o=n.getCollectionGuaranteesList(),s=n.getBlockSealsList(),i=n.getSignaturesList().map(function(e){return Y(e,t)}),a=t.response();return a.tag=e.tag,a.block={id:Y(n.getId_asU8(),t),parentId:Y(n.getParentId_asU8(),t),height:n.getHeight(),timestamp:n.getTimestamp().toDate().toISOString(),collectionGuarantees:o.map(function(e){return{collectionId:Y(e.getCollectionId_asU8(),t),signatures:e.getSignaturesList().map(function(e){return Y(e,t)})}}),blockSeals:s.map(function(e){return{blockId:Y(e.getBlockId_asU8(),t),executionReceiptId:Y(e.getExecutionReceiptId_asU8(),t),executionReceiptSignatures:e.getExecutionReceiptSignaturesList().map(function(e){return Y(e,t)}),resultApprovalSignatures:e.getResultApprovalSignaturesList().map(function(e){return Y(e,t)})}}),signatures:i},a}var te=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{e(o.node,"SDK Send Get Collection Error: opts.node must be defined."),e(n.response,"SDK Send Get Collection Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Collection Error: context.Buffer must be defined.");var s=o.unary||x;return Promise.resolve(t).then(function(e){t=e;var i=new g;return i.setId(ne(t.collection.id,n)),Promise.resolve(s(o.node,r.GetCollectionByID,i,n)).then(function(e){var r=e.getCollection(),o=n.response();return o.tag=t.tag,o.collection={id:re(r.getId_asU8(),n),transactionIds:r.getTransactionIdsList().map(function(e){return re(e,n)})},o})})}catch(e){return Promise.reject(e)}},re=function(e,t){return t.Buffer.from(e).toString("hex")},ne=function(e,t){return t.Buffer.from(e,"hex")},oe=function(t,r,n){void 0===r&&(r={}),void 0===n&&(n={});try{return e(n.node,"SDK Send Get Events Error: opts.node must be defined."),e(r.response,"SDK Send Get Events Error: context.response must be defined."),e(r.Buffer,"SDK Send Get Events Error: context.Buffer must be defined."),Promise.resolve(t).then(function(o){var s=null!==(t=o).events.start,i=Array.isArray(t.events.blockIds)&&t.events.blockIds.length>0;return e(s||i,"SendGetEventsError: Unable to determine which get events request to send. Either a block height range, or block IDs must be specified."),Promise.resolve(s?ie(t,r,n):se(t,r,n))})}catch(e){return Promise.reject(e)}},se=function(e,t,n){try{var o=n.unary||x,s=new m;return s.setType(e.events.eventType),e.events.blockIds.forEach(function(e){return s.addBlockIds(ue(e,t))}),Promise.resolve(o(n.node,r.GetEventsForBlockIDs,s,t)).then(function(r){return ce(e,t,r)})}catch(e){return Promise.reject(e)}},ie=function(e,t,n){try{var o=n.unary||x,s=new p;return s.setType(e.events.eventType),s.setStartHeight(Number(e.events.start)),s.setEndHeight(Number(e.events.end)),Promise.resolve(o(n.node,r.GetEventsForHeightRange,s,t)).then(function(r){return ce(e,t,r)})}catch(e){return Promise.reject(e)}},ae=function(e,t){return t.Buffer.from(e).toString("hex")},ue=function(e,t){return t.Buffer.from(e,"hex")};function ce(e,t,r){var n=t.response();n.tag=e.tag;var o=r.getResultsList();return n.events=o.reduce(function(e,r){var n=ae(r.getBlockId_asU8(),t),o=r.getBlockHeight(),s=r.getBlockTimestamp().toDate().toISOString();return r.getEventsList().forEach(function(r){e.push({blockId:n,blockHeight:o,blockTimestamp:s,type:r.getType(),transactionId:ae(r.getTransactionId_asU8(),t),transactionIndex:r.getTransactionIndex(),eventIndex:r.getEventIndex(),payload:JSON.parse(t.Buffer.from(r.getPayload_asU8()).toString("utf8"))})}),e},[]),n}var de=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{return e(o.node,"SDK Send Get Latest Block Error: opts.node must be defined."),e(n.response,"SDK Send Get Latest Block Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Latest Block Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){t=e;var s=new d;return t.latestBlock&&t.latestBlock.isSealed&&(s.setIsSealed(t.latestBlock.isSealed),le()),t.block&&t.block.isSealed&&s.setIsSealed(t.block.isSealed),Promise.resolve(x(o.node,r.GetLatestBlock,s,n)).then(function(e){var r=e.getBlock(),o=r.getCollectionGuaranteesList(),s=r.getBlockSealsList(),i=r.getSignaturesList(),a=n.response();return a.tag=t.tag,a.block={id:fe(r.getId_asU8(),n),parentId:fe(r.getParentId_asU8(),n),height:r.getHeight(),timestamp:r.getTimestamp(),collectionGuarantees:o.map(function(e){return{collectionId:fe(e.getCollectionId_asU8(),n),signatures:e.getSignaturesList()}}),blockSeals:s.map(function(e){return{blockId:fe(e.getBlockId_asU8(),n),executionReceiptId:fe(e.getExecutionReceiptId_asU8(),n),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:i},a})})}catch(e){return Promise.reject(e)}},fe=function(e,t){return t.Buffer.from(e).toString("hex")},le=function(){console.error("\n          %c@onflow/send Deprecation Notice\n          ========================\n\n          Operating upon data of the latestBlock field of the interaction object is deprecated and will no longer be recognized in future releases of @onflow/send.\n          Find out more here: https://github.com/onflow/flow-js-sdk/blob/master/packages/send/WARNINGS.md#0001-Deprecating-latestBlock-field\n\n          =======================\n        ".replace(/\n\s+/g,"\n").trim(),"font-weight:bold;font-family:monospace;")},ge=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{e(o.node,"SDK Send Get Transaction Error: opts.node must be defined."),e(n.response,"SDK Send Get Transaction Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Transaction Error: context.Buffer must be defined.");var s=o.unary||x;return Promise.resolve(t).then(function(e){t=e;var i=new S;return i.setId(pe(t.transaction.id,n)),Promise.resolve(s(o.node,r.GetTransaction,i,n)).then(function(e){var r=n.response();r.tag=t.tag;var o,s=function(e){return{address:me(e.getAddress_asU8(),n),keyId:e.getKeyId(),signature:me(e.getSignature_asU8(),n)}},i=e.getTransaction();return r.transaction={script:n.Buffer.from(i.getScript_asU8()).toString("utf8"),args:i.getArgumentsList().map(function(e){return JSON.parse(n.Buffer.from(e).toString("utf8"))}),referenceBlockId:me(i.getReferenceBlockId_asU8(),n),gasLimit:i.getGasLimit(),proposalKey:(o=i.getProposalKey(),{address:me(o.getAddress_asU8(),n),keyId:o.getKeyId(),sequenceNumber:o.getSequenceNumber()}),payer:me(i.getPayer_asU8(),n),authorizers:i.getAuthorizersList().map(function(e){return me(e,n)}),payloadSignatures:i.getPayloadSignaturesList().map(s),envelopeSignatures:i.getEnvelopeSignaturesList().map(s)},r})})}catch(e){return Promise.reject(e)}},me=function(e,t){return t.Buffer.from(e).toString("hex")},pe=function(e,t){return t.Buffer.from(e,"hex")},Se=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{e(o.node,"SDK Send Get Transaction Status Error: opts.node must be defined."),e(n.response,"SDK Send Get Transaction Status Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Transaction Status Error: context.Buffer must be defined.");var s=o.unary||x;return Promise.resolve(t).then(function(e){t=e;var i=new S;return i.setId(Be(t.transaction.id,n)),Promise.resolve(s(o.node,r.GetTransactionResult,i,n)).then(function(e){var r=e.getEventsList(),o=n.response();return o.tag=t.tag,o.transactionStatus={status:e.getStatus(),statusString:he[e.getStatus()],statusCode:e.getStatusCode(),errorMessage:e.getErrorMessage(),events:r.map(function(e){return{type:e.getType(),transactionId:ve(e.getTransactionId_asU8(),n),transactionIndex:e.getTransactionIndex(),eventIndex:e.getEventIndex(),payload:JSON.parse(n.Buffer.from(e.getPayload_asU8()).toString("utf8"))}})},o})})}catch(e){return Promise.reject(e)}},he={0:"UNKNOWN",1:"PENDING",2:"FINALIZED",3:"EXECUTED",4:"SEALED",5:"EXPIRED"},ve=function(e,t){return t.Buffer.from(e).toString("hex")},Be=function(e,t){return t.Buffer.from(e,"hex")},ke=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{e(o.node,"SDK Send Ping Error: opts.node must be defined."),e(n.response,"SDK Send Ping Error: context.response must be defined.");var s=o.unary||x;return Promise.resolve(t).then(function(e){t=e;var i=new h;return Promise.resolve(s(o.node,r.Ping,i,n)).then(function(e){var r=n.response();return r.tag=t.tag,r})})}catch(e){return Promise.reject(e)}},ye=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{e(o.node,"SDK Send Transaction Error: opts.node must be defined."),e(n.response,"SDK Send Transaction Error: context.response must be defined."),e(n.Buffer,"SDK Send Transaction Error: context.Buffer must be defined.");var s=o.unary||x;return Promise.resolve(t).then(function(e){t=e;var i=new v;i.setScript(Ie(t.message.cadence,n)),i.setGasLimit(t.message.computeLimit),i.setReferenceBlockId(t.message.refBlock?xe(t.message.refBlock,n):null),i.setPayer(Ee(b(t.accounts[t.payer].addr),n)),t.message.arguments.forEach(function(e){return i.addArguments(Pe(t.arguments[e].asArgument,n))}),t.authorizations.map(function(e){return t.accounts[e].addr}).reduce(function(e,t){return e.find(function(e){return e===t})?e:[].concat(e,[t])},[]).forEach(function(e){return i.addAuthorizers(Ee(b(e),n))});var a=new v.ProposalKey;a.setAddress(Ee(b(t.accounts[t.proposer].addr),n)),a.setKeyId(t.accounts[t.proposer].keyId),a.setSequenceNumber(t.accounts[t.proposer].sequenceNum),i.setProposalKey(a);for(var u=0,c=Object.values(t.accounts);u<c.length;u++){var d=c[u];try{if(!d.role.payer&&null!=d.signature){var f=new v.Signature;f.setAddress(Ee(b(d.addr),n)),f.setKeyId(d.keyId),f.setSignature(xe(d.signature,n)),i.addPayloadSignatures(f)}}catch(e){throw console.error("Trouble applying payload signature",{acct:d,ix:t}),e}}for(var l=0,g=Object.values(t.accounts);l<g.length;l++){var m=g[l];try{if(m.role.payer&&null!=m.signature){var p=new v.Signature;p.setAddress(Ee(b(m.addr),n)),p.setKeyId(m.keyId),p.setSignature(xe(m.signature,n)),i.addEnvelopeSignatures(p)}}catch(e){throw console.error("Trouble applying envelope signature",{acct:m,ix:t}),e}}var S=new B;S.setTransaction(i);var h=Date.now();return Promise.resolve(s(o.node,r.SendTransaction,S,n)).then(function(e){var r=Date.now(),o=n.response();return o.tag=t.tag,o.transactionId=be(e.getId_asU8(),n),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("FLOW::TX",{detail:{txId:o.transactionId,delta:r-h}})),o})})}catch(e){return Promise.reject(e)}},be=function(e,t){return t.Buffer.from(e).toString("hex")},Ie=function(e,t){return t.Buffer.from(e,"utf8")},xe=function(e,t){return t.Buffer.from(e,"hex")},Ee=function(e,t){return function(e,t,r){return r.Buffer.from(e.padStart(16,0),"hex")}(e,0,t)},Pe=function(e,t){return t.Buffer.from(JSON.stringify(e),"utf8")},Ge=function(e,t){return t.Buffer.from(e).toString("hex")},De=function(e,t){return t.Buffer.from(e).toString("hex")},Ae=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{return e(o.node,'SDK Send Error: Either opts.node or "accessNode.api" in config must be defined.'),e(n.ix,"SDK Send Error: context.ix must be defined."),Promise.resolve(t).then(function(s){switch(t=s,!0){case n.ix.isTransaction(t):return o.sendTransaction?o.sendTransaction(t,n,o):ye(t,n,o);case n.ix.isGetTransactionStatus(t):return o.sendGetTransactionStatus?o.sendGetTransactionStatus(t,n,o):Se(t,n,o);case n.ix.isGetTransaction(t):return o.sendGetTransaction?o.sendGetTransaction(t,n,o):ge(t,n,o);case n.ix.isScript(t):return o.sendExecuteScript?o.sendExecuteScript(t,n,o):E(t,n,o);case n.ix.isGetAccount(t):return o.sendGetAccount?o.sendGetAccount(t,n,o):_(t,n,o);case n.ix.isGetEvents(t):return o.sendGetEvents?o.sendGetEvents(t,n,o):oe(t,n,o);case n.ix.isGetLatestBlock(t):return o.sendGetLatestBlock?o.sendGetLatestBlock(t,n,o):de(t,n,o);case n.ix.isGetBlock(t):return o.sendGetBlock?o.sendGetBlock(t,n,o):X(t,n,o);case n.ix.isGetBlockHeader(t):return o.sendGetBlockHeader?o.sendGetBlockHeader(t,n,o):O(t,n,o);case n.ix.isGetBlockById(t):return o.sendGetBlockById?o.sendGetBlockById(t,n,o):function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{return e(o.node,"SDK Send Get Block By ID Error: opts.node must be defined."),e(n.response,"SDK Send Get Block By ID Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Block By ID Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){t=e;var s=new l;return s.setId(function(e,t){return t.Buffer.from(e,"hex")}(t.block.id,n)),Promise.resolve(x(o.node,r.GetBlockByID,s,n)).then(function(e){var r=e.getBlock(),o=r.getCollectionGuaranteesList(),s=r.getBlockSealsList(),i=r.getSignaturesList(),a=n.response();return a.tag=t.tag,a.block={id:Ge(r.getId_asU8(),n),parentId:Ge(r.getParentId_asU8(),n),height:r.getHeight(),timestamp:r.getTimestamp(),collectionGuarantees:o.map(function(e){return{collectionId:Ge(e.getCollectionId_asU8(),n),signatures:e.getSignaturesList()}}),blockSeals:s.map(function(e){return{blockId:Ge(e.getBlockId_asU8(),n),executionReceiptId:Ge(e.getExecutionReceiptId_asU8(),n),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:i},a})})}catch(e){return Promise.reject(e)}}(t,n,o);case n.ix.isGetBlockByHeight(t):return o.sendGetBlockByHeight?o.sendGetBlockByHeight(t,n,o):function(t,n,o){void 0===n&&(n={}),void 0===o&&(o={});try{return e(o.node,"SDK Send Get Block By Height Error: opts.node must be defined."),e(n.response,"SDK Send Get Block By Height Error: context.response must be defined."),e(n.Buffer,"SDK Send Get Block By Height Error: context.Buffer must be defined."),Promise.resolve(t).then(function(e){t=e;var s=new f;return s.setHeight(Number(t.block.height)),Promise.resolve(x(o.node,r.GetBlockByHeight,s,n)).then(function(e){var r=e.getBlock(),o=r.getCollectionGuaranteesList(),s=r.getBlockSealsList(),i=r.getSignaturesList(),a=n.response();return a.tag=t.tag,a.block={id:De(r.getId_asU8(),n),parentId:De(r.getParentId_asU8(),n),height:r.getHeight(),timestamp:r.getTimestamp(),collectionGuarantees:o.map(function(e){return{collectionId:De(e.getCollectionId_asU8(),n),signatures:e.getSignaturesList()}}),blockSeals:s.map(function(e){return{blockId:De(e.getBlockId_asU8(),n),executionReceiptId:De(e.getExecutionReceiptId_asU8(),n),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:i},a})})}catch(e){return Promise.reject(e)}}(t,n,o);case n.ix.isGetCollection(t):return o.sendGetCollection?o.sendGetCollection(t,n,o):te(t,n,o);case n.ix.isPing(t):return o.sendPing?o.sendPing(t,n,o):ke(t,n,o);default:return t}})}catch(e){return Promise.reject(e)}};export{Ae as send,E as sendExecuteScript,_ as sendGetAccount,X as sendGetBlock,O as sendGetBlockHeader,te as sendGetCollection,oe as sendGetEvents,de as sendGetLatestBlock,ge as sendGetTransaction,Se as sendGetTransactionStatus,ke as sendPing,ye as sendTransaction};
//# sourceMappingURL=sdk-send-grpc.module.js.map
